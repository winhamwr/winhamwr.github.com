<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <title>Testing for Pythonistas: nose and pytest</title>

  <meta name="viewport" content="width=device-width"/>

  <link rel="stylesheet" href="./css/reset.css" type="text/css"/>
  <link rel="stylesheet" href="./css/showoff.css" type="text/css"/>

  <script type="text/javascript" src="./js/jquery-1.4.2.min.js"></script>
  <script type="text/javascript" src="./js/jquery.cycle.all.js"></script>
	<script type="text/javascript" src="./js/jquery-print.js"></script>
  <script type="text/javascript" src="./js/jquery.batchImageLoad.js"></script>

  <script type="text/javascript" src="./js/jquery.doubletap-0.1.js"></script>

  <script type="text/javascript" src="./js/fg.menu.js"></script>
  <script type="text/javascript" src="./js/showoff.js"></script>
  <script type="text/javascript" src="./js/jTypeWriter.js"> </script>
  <script type="text/javascript" src="./js/sh_main.min.js"></script>
  <script type="text/javascript" src="./js/core.js"></script>
  <script type="text/javascript" src="./js/showoffcore.js"></script>
  <script type="text/javascript" src="./js/coffee-script.js"></script>

  <link type="text/css" href="./css/fg.menu.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/theme/ui.all.css" media="screen" rel="stylesheet" />
  <link type="text/css" href="./css/sh_style.css" rel="stylesheet" >

  
    <link rel="stylesheet" href="file/style.css" type="text/css"/>
  

  

  <script type="text/javascript">
  $(function(){
      setupPreso(false, './');
  });
  </script>

</head>

<body>

<a tabindex="0" href="#search-engines" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="navmenu"><span class="ui-icon ui-icon-triangle-1-s"></span>slides</a>
<div id="navigation" class="hidden"></div>

<div id="help">
  <table>
    <tr><td class="key">z, ?</td><td>toggle help (this)</td></tr>
    <tr><td class="key">space, &rarr;</td><td>next slide</td></tr>
    <tr><td class="key">shift-space, &larr;</td><td>previous slide</td></tr>
    <tr><td class="key">d</td><td>toggle debug mode</td></tr>
    <tr><td class="key">## &lt;ret&gt;</td><td>go to slide #</td></tr>
    <tr><td class="key">c, t</td><td>table of contents (vi)</td></tr>
    <tr><td class="key">f</td><td>toggle footer</td></tr>
    <tr><td class="key">r</td><td>reload slides</td></tr>
    <tr><td class="key">n</td><td>toggle notes</td></tr>
    <tr><td class="key">p</td><td>run preshow</td></tr>
  </table>
</div>

<div class="buttonNav">
  <input type="submit" onClick="prevStep();" value="prev"/>
  <input type="submit" onClick="nextStep();" value="next"/>
</div>

<div id="preso">loading presentation...</div>
<div id="footer">
  <span id="slideInfo"></span>
  <span id="debugInfo"></span>
  <span id="notesInfo"></span>
</div>

<div id="slides" class="offscreen" style="display:none;">
<div class="slide" data-transition="none"><div class="content" ref="title_slide/01_slide">
<h1>Testing for Pythonistas: nose and pytest</h1>

<ul>
<li>Why nose and pytest are better than unittest</li>
<li>How to write and run pythonic tests</li>
<li>Using plugins to solve real-world problems</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets incremental" ref="intro/01_outline">
<h1>hello</h1>

<ul>
<li>Wes Winham @weswinham, <a href="http://github.com/winhamwr">github.com/winhamwr</a></li>
<li>Responsible for product development at PolicyStat</li>
<li>~7 year old Django app, ~1 million monthly page views</li>
<li>0-4700 "unit" tests, 0-200 selenium tests</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/1">
<h1>Testing Matters</h1></div>
</div><div class="slide" data-transition="none"><div class="content fullscreen center" ref="content/01_slide/2">
<p><img src="./file/content/testing_my_code.gif" width="246" height="185" style="width=504px; height=382px" width="504" height="382"/>

<br/>


</p>
</div>
</div><div class="slide" data-transition="none"><div class="content fullscreen center" ref="content/01_slide/3">
<p><img src="./file/content/untested_code.gif" width="480" height="480"/>

<br/>


</p>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/4">
<h1>Today</h1>

<ul>
<li>I'll show you how to write and run tests</li>
<li>Randy- How to test effectively</li>
<li>Randy- How to test difficult things</li>
<li>Rob- Keep things fast and scalable</li>
<li>Calvin- Run those awesome tests</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/5">
<h1>Write Tests!</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/6">
<h1>you'll get...</h1>

<ul>
<li>Better code design</li>
<li>Quicker implementation to working code</li>
<li>Refactoring with abandon</li>
<li>Fearless updates</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/7">
<h1>Good Tools Matter</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/8">
<h1>Master testers can...</h1>

<ul>
<li>Eliminate boilerplate</li>
<li>Write maintainable tests (tests are code)</li>
<li>Pick the right tool</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/9">
<h1>Part 1: Pythonic Testing</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/10">
<pre class="sh_python"><code># add_one.py
def add_one(x):
    return x + 1</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/11">
<h1>Zen of python</h1>

<ul>
<li>Simple is better than complex.</li>
<li>Flat is better than nested.</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/12">
<pre class="sh_python"><code>import unittest
from add_one import add_one

class AddOneTest(unittest.TestCase):
    def test_negative_one(self):
        self.assertEqual(add_one(-1), 0)

if __name__ == '__main__':
    unittest.main()</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/13">
<h2>Is this Java?</h2></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/14">
<h2>nose or pytest!</h2></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/15">
<pre class="sh_python"><code># test.py
from add_one import add_one

def test_negative_one():
    assert add_one(-1) == 0</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/16">
<h2>Complex tests</h2>

<ul>
<li>Test fixtures</li>
<li>Test cleanup</li>
<li>Stdout</li>
<li>Filesystem</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/17">
<h2>Example: Easy filesystem tests</h2></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/18">
<pre class="sh_python"><code># test_tmpdir.py
def test_needsfiles(tmpdir):
    print (tmpdir)
    assert 0</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/19">
<h1>History of python testing</h1></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/20">
<h2>In the beginning, unittest</h2></div>
</div><div class="slide" data-transition="none"><div class="content fullscreen center" ref="content/01_slide/21">
<p><img src="./file/content/sad_guy.png" width="680" height="875"/>

<br/>


</p>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/22">
<h2>History: Rise of nose</h2>

<ul>
<li>pytest first, easy test discovery</li>
<li>~2007 nose is easy to install</li>
<li>Works with unittest for free</li>
<li>More extensive plugin system</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/23">
<h2>History: pytest resurgence</h2>

<ul>
<li>Feature parity since 2009-2011</li>
<li>Better documentation</li>
<li>Better parameterized fixtures</li>
<li>Both good plugin ecosystems</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/24">
<h1>Installation</h1>

<ul>
<li><code>$ virtualenv tfp</code></li>
<li><code>$ pip install nose pytest</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/25">
<h1>Why you should use them</h1></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/26">
<h1>Better: Test discovery and running</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/27">
<pre class="sh_python"><code>import unittest

if __name__ == '__main__':
    unittest.main()</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/28">
<h2>They run everything</h2>

<ul>
<li>unittest cases</li>
<li><code>test_FOO</code> modules</li>
<li><code>test</code> functions</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/29">
<h2>Discovery options: 1</h2>

<ul>
<li><code>$ nosetests only_test_this.py</code></li>
<li><code>$ nosetests test.module</code></li>
<li><code>$ nosetests another.test:TestCase.test_method</code></li>
<li><code>$ nosetests a.test:TestCase</code></li>
<li><code>$ nosetests /path/to/test/file.py:test_function</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/30">
<h2>Discovery options: 2</h2>

<ul>
<li><code>$ py.test only_test_this.py</code></li>
<li><code>$ nosetests</code></li>
<li><code>$ py.test</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/31">
<h1>Runs doctests</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/32">
<pre class="sh_python"><code># add_one.py
def add_one(x):
    """
    &gt;&gt;&gt; add_one(-1)
    0
    """
    return x + 1</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/33">
<h1>Test type: class</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/34">
<pre class="sh_python"><code>from add_one import add_one

class AddOneTest:
    def test_negative_one(self):
        assert add_one(-1) == 0</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/35">
<h1>Test type: generator</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/36">
<pre class="sh_python"><code>def test_evens():
    for i in range(0, 5):
        yield check_even, i, i*3

def check_even(n, nn):
    assert n % 2 == 0 or nn % 2 == 0</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/37">
<h1>Setup/Teardown types</h1>

<ul>
<li>Module</li>
<li>Class</li>
<li>Function (decorators)</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/38">
<pre class="sh_python"><code>from add_one import add_one

class AddOneTest:
    def set_up(self):
        # Do work

    def test_negative_one(self):
        assert add_one(-1) == 0</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/39">
<h1>Configuration: nose</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/40">
<pre class="sh_ini"><code># setup.cfg, .noserc or nose.cfg
[nosetests]
verbosity=3
with-doctest=1</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/41">
<h1>Configuration: pytest</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/42">
<pre class="sh_ini"><code># pytest.ini, tox.ini or setup.cfg
[pytest]
python_files=*.py
norecursedirs = _build</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/43">
<h1>pytest: Fixture injection</h1>

<ul>
<li>Examples from <a href="http://www.pydanny.com/pytest-no-boilerplate-testing-2.html">Danny Greenfield</a></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/44">
<pre class="sh_python"><code># test_fixtures.py
from pytest import fixture

@fixture
def complex_data():
    class DataTypes(object):
        string = str
        list = list
    return DataTypes()

def test_types(complex_data):
    assert isinstance(
        "Elephant", complex_data.string)
    assert isinstance(
        [5, 10, 15], complex_data.list)</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/45">
<h1>pytest: Tests for tests</h1></div>
</div><div class="slide" data-transition="none"><div class="content code fullscreen" ref="content/01_slide/46">
<pre class="sh_python"><code># test_fixtures.py
# note: this version of test_fixtures.py is built off the previous example

def test_complex_data(complex_data):
    assert isinstance(complex_data, object)
    assert complex_data.string == str
    assert complex_data.list == list</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/47">
<h1>Debugging: PDB on failures</h1>

<ul>
<li><code>$ nosetests --pdb</code></li>
<li><code>$ py.test --pdb</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/48">
<h1>Debugging: PDB when you want</h1>

<pre class="sh_python"><code>from nose.tools import set_trace
from pytest import set_trace

...
set_trace()</code></pre></div>
</div><div class="slide" data-transition="none"><div class="content subsection" ref="content/01_slide/49">
<h1>Plugins</h1></div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/50">
<h1>Plugins: For (almost) everything</h1>

<ul>
<li>Your favorite web framework</li>
<li>Code coverage</li>
<li>Tox</li>
<li>Parallel test running</li>
<li>xUnit output</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/51">
<h1>Plugins: Sources</h1>

<ul>
<li><a href="http://pytest-plugs.herokuapp.com/">pytest-plugs</a></li>
<li><a href="http://nose.readthedocs.org/en/latest/plugins/builtin.html">nose builtin</a></li>
<li><a href="https://nose-plugins.jottit.com/">nose 3rd party</a></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/52">
<h1>Plugin: Tox</h1>

<ul>
<li>Test combinations of things</li>
<li>Different python versions</li>
<li>Different requirements</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/53">
<h1>Plugin: Parallel Test Running</h1>

<ul>
<li><code>$ nosetests --processes=2</code></li>
<li><code>$ pip install pytest-xdist</code></li>
<li><code>$ py.test -n 2</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/54">
<h1>Plugin: Shared-nothing Distributed Test Running</h1>

<ul>
<li><a href="https://github.com/PolicyStat/distributed-nose">distributed-nose</a></li>
<li><code>$ export NOSE_NODES=2;</code></li>
<li><code>$ export NOSE_NODE_NUMBER=1;</code></li>
<li><code>$ nosetests long_test_suite</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/55">
<h1>Plugin: xUnit output</h1>

<ul>
<li><code>$ py.test --junitxml=path</code></li>
<li><code>$ nosetests --with-xunit</code></li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content bullets" ref="content/01_slide/56">
<h1>Plugin authoring</h1>

<ul>
<li>All the hooks!</li>
<li>Plugin with a plugin system</li>
<li>e.g. fulltext search setup/teardown</li>
</ul>
</div>
</div><div class="slide" data-transition="none"><div class="content fullscreen center" ref="content/01_slide/57">
<p><img src="./file/content/../pstat_logo.gif" width="260" height="55"/>

<br/>


<p>We're hiring!</p>
</p>
</div>
</div></div>

</body>
</html>
